{"name":"Alice","entityType":"Person","observations":["Software Engineer","Lives in NYC","Loves coding","Age 28"]}
{"name":"Bob","entityType":"Person","observations":["Doctor","Works at hospital","Age 32"]}
{"name":"Memory Graph MCP Server","entityType":"Project","observations":["D·ª± √°n gi√∫p AI Agent qu·∫£n l√Ω d·ª± √°n ph·∫ßn m·ªÅm t·ªët h∆°n","Ch·ªëng ·∫£o gi√°c (fact anchoring) b·∫±ng knowledge graph","ƒê·∫£m b·∫£o ƒë·ªô ch√≠nh x√°c qua th·ªùi gian","S·ª≠ d·ª•ng Rust l√†m ng√¥n ng·ªØ ch√≠nh","L∆∞u tr·ªØ d·ªØ li·ªáu b·∫±ng JSONL format","Tu√¢n th·ªß giao th·ª©c MCP (Model Context Protocol)","C√≥ 9 memory tools: create_entities, create_relations, add_observations, delete_entities, delete_observations, delete_relations, read_graph, search_nodes, open_nodes","Total tools: 13 (9 memory + 3 query + 1 time)","New tools added: get_related, traverse, summarize","EXISTING CAPABILITIES (pre-reasoning):","1. Structural reasoning - graph traversal via get_related, traverse, path_pattern","2. Temporal reasoning - time-aware via created_at, validFrom/validTo, get_relations_at_time","3. Causal tracing - edges: affects, threatens, depends_on (g·∫ßn ƒë·ªß, ch∆∞a c√≥ formal semantics)","MISSING FOR TRUE REASONING:","1. Semantic grounding - relationType l√† string, thi·∫øu: strength, transitivity rules","2. Inference rules - kh√¥ng t·ª± k·∫øt lu·∫≠n, ch·ªâ tr·∫£ l·ªùi c√¢u h·ªèi ƒë∆∞·ª£c h·ªèi","3. Uncertainty - thi·∫øu confidence, probability, competing hypotheses","EVOLUTION PATH: Rules (Layer 1) ‚Üí Typed Relations (Layer 2) ‚Üí Embeddings (Layer 3) ‚Üí Hybrid Neuro-Symbolic (Layer 4)","=== Event Sourcing Architecture COMPLETED (2026-01-11) ===","New module: src/event_store/ v·ªõi 6 files","Phases completed: 0-8 (Preparation ‚Üí Enhancements)","Tests: 73 total (57 unit + 7 E2E + 8 integration)","Enable: MEMORY_EVENT_SOURCING=true","Features: Append-only event log, Snapshots, Migration, Log rotation, Stats collection","MCP SSE transport implemented (2026-01-13)","SSE endpoint: /mcp/sse accepts GET (stream) + POST (messages)","REST API: 6 endpoints for client recovery","All 16 tools registered via get_all_tools()"],"updatedBy":"Mai Th√†nh Duy An","updatedAt":1768313916}
{"name":"tiach","entityType":"Developer","observations":["L√† developer ch√≠nh c·ªßa d·ª± √°n Memory Graph","M·ª•c ti√™u: x√¢y d·ª±ng h·ªá th·ªëng gi√∫p AI kh√¥ng qu√™n th√¥ng tin quan tr·ªçng"]}
{"name":"Feature: Create Entities","entityType":"Feature","observations":["M√¥ t·∫£: T·∫°o m·ªõi entities trong knowledge graph","Status: Completed","Priority: High","File: memory.rs - function create_entities"]}
{"name":"Feature: Create Relations","entityType":"Feature","observations":["M√¥ t·∫£: T·∫°o quan h·ªá gi·ªØa c√°c entities","Status: Completed","Priority: High","File: memory.rs - function create_relations"]}
{"name":"Feature: Search Nodes","entityType":"Feature","observations":["M√¥ t·∫£: T√¨m ki·∫øm entities theo query text","Status: Completed","Priority: High","File: memory.rs - function search_nodes","Depends on: src/search/synonyms.rs for matches_with_synonyms()","Used by: knowledge_base/query.rs - search_nodes function"],"updatedBy":"Mai Th√†nh Duy An","updatedAt":1768107430}
{"name":"Feature: Persistent Storage","entityType":"Feature","observations":["M√¥ t·∫£: L∆∞u tr·ªØ d·ªØ li·ªáu v√†o file JSONL","Status: Completed","Priority: Critical","File: memory.jsonl"]}
{"name":"Decision: Use JSONL Format","entityType":"Decision","observations":["Quy·∫øt ƒë·ªãnh: S·ª≠ d·ª•ng JSONL thay v√¨ SQLite","L√Ω do: ƒê∆°n gi·∫£n, human-readable, d·ªÖ debug","Trade-offs: Query ch·∫≠m h∆°n v·ªõi dataset l·ªõn (>100K entities)","Ng√†y: 2026-01-10","Quy·∫øt ƒë·ªãnh b·ªüi: tiach"]}
{"name":"Decision: Use Rust","entityType":"Decision","observations":["Quy·∫øt ƒë·ªãnh: S·ª≠ d·ª•ng Rust l√†m ng√¥n ng·ªØ ch√≠nh","L√Ω do: Performance cao, memory safety, single binary deployment","Trade-offs: Learning curve cao h∆°n Python/Node.js","Ng√†y: 2026-01-10","Quy·∫øt ƒë·ªãnh b·ªüi: tiach"]}
{"name":"Milestone: MVP Release","entityType":"Milestone","observations":["M√¥ t·∫£: Release phi√™n b·∫£n MVP v·ªõi 9 tools c∆° b·∫£n","Target date: 2026-01-15","Deliverables: Binary, Documentation, Basic Tests","Status: In Progress"]}
{"name":"Milestone: Production Ready","entityType":"Milestone","observations":["M√¥ t·∫£: Phi√™n b·∫£n ·ªïn ƒë·ªãnh cho production","Target date: 2026-02-01","Deliverables: Full test coverage, Performance benchmarks, User guide","Status: Planned"]}
{"name":"Requirement: Unicode Support","entityType":"Requirement","observations":["M√¥ t·∫£: H·ªó tr·ª£ Unicode trong entity name v√† observations","Type: Functional","Priority: High","Status: Implemented"]}
{"name":"Requirement: MCP Compliance","entityType":"Requirement","observations":["M√¥ t·∫£: Tu√¢n th·ªß Model Context Protocol specification","Type: Functional","Priority: Critical","Status: Implemented"]}
{"name":"Risk: JSONL Scalability","entityType":"Risk","observations":["M√¥ t·∫£: Performance degradation v·ªõi >100K entities","Impact: Medium","Probability: Low (most use cases < 10K entities)","Mitigation: Implement indexing ho·∫∑c optional SQLite backend","Status: Accepted"]}
{"name":"Risk: Memory Usage","entityType":"Risk","observations":["M√¥ t·∫£: RAM usage cao khi load to√†n b·ªô graph v√†o memory","Impact: Medium","Probability: Low","Mitigation: Implement lazy loading ho·∫∑c streaming","Status: Monitoring"]}
{"name":"Feature: GNN Integration","entityType":"Feature","observations":["M√¥ t·∫£: T√≠ch h·ª£p Graph Neural Network ƒë·ªÉ n√¢ng cao kh·∫£ nƒÉng AI Agent","Status: Planned","Priority: Medium","Target Milestone: Post-Production","Capability 1: Semantic Search - t√¨m nodes t∆∞∆°ng t·ª± v·ªÅ √Ω nghƒ©a s·ª≠ d·ª•ng node embeddings","Capability 2: Link Prediction - ƒë·ªÅ xu·∫•t relations m·ªõi d·ª±a tr√™n graph structure","Capability 3: Node Embeddings - encode context t·ª´ neighboring nodes","Capability 4: Multi-hop Reasoning - suy lu·∫≠n qua nhi·ªÅu relations","Tech Options: PyTorch Geometric, DGL, ho·∫∑c custom Rust implementation","Dependencies: Requires embedding infrastructure first"]}
{"name":"Feature: Semantic Search","entityType":"Feature","observations":["M√¥ t·∫£: T√¨m ki·∫øm entities b·∫±ng semantic similarity thay v√¨ text matching","Status: Planned","Priority: High","Target Milestone: Production Ready","Approach: Embed entity text (name + type + observations) th√†nh vectors","Storage: Separate vector file (memory.vec) ho·∫∑c extend JSONL","Tech Options: Ollama API (short-term), ONNX Runtime (long-term)","Prerequisite for: Feature: GNN Integration"]}
{"name":"EntityType: Module","entityType":"EntityType","observations":["M√¥ t·∫£: ƒê·∫°i di·ªán cho m·ªôt module/package trong d·ª± √°n","Required fields: name, path","Observations n√™n c√≥: Purpose, Dependencies, Public API, Key files","Example: Module: Payment - backend/src/payment/","Relations: belongs_to Project, contains File, depends_on Module"]}
{"name":"EntityType: File","entityType":"EntityType","observations":["M√¥ t·∫£: File quan tr·ªçng trong d·ª± √°n","Required fields: name (v·ªõi path), language","Observations n√™n c√≥: Purpose, Key functions, Exports, Line count","Example: File: order_service.rs - backend/src/order/","Relations: belongs_to Module, contains Function, imports File"]}
{"name":"EntityType: Function","entityType":"EntityType","observations":["M√¥ t·∫£: Function/method ph·ª©c t·∫°p c·∫ßn nh·ªõ","Required fields: name, signature","Observations n√™n c√≥: Purpose, Parameters, Return type, Side effects, Complexity notes","Example: Function: create_order(user_id, items) -> Result<Order>","Relations: defined_in File, calls Function, uses Schema"]}
{"name":"EntityType: Schema","entityType":"EntityType","observations":["M√¥ t·∫£: Database table, API schema, data structure","Required fields: name, type (table/api/struct)","Observations n√™n c√≥: Fields, Types, Indexes, Constraints, Relationships","Example: Schema: orders - PostgreSQL table","Relations: used_by Function, relates_to Schema"]}
{"name":"EntityType: BusinessRule","entityType":"EntityType","observations":["M√¥ t·∫£: Business logic v√† quy t·∫Øc nghi·ªáp v·ª•","Required fields: name, domain","Observations n√™n c√≥: Rule description, Conditions, Edge cases, Exceptions","Example: BusinessRule: Free Shipping >= 500k VND","Relations: implemented_by Function, affects Feature"]}
{"name":"EntityType: Convention","entityType":"EntityType","observations":["M√¥ t·∫£: Coding conventions v√† patterns c·ªßa d·ª± √°n","Required fields: name, scope (project/module/language)","Observations n√™n c√≥: Rule, Examples, Exceptions, Reasoning","Example: Convention: Error Handling - d√πng Result<T, AppError>","Relations: applies_to Project/Module, enforced_by Linter"]}
{"name":"EntityType: Dependency","entityType":"EntityType","observations":["M√¥ t·∫£: External dependencies (crates, npm packages, etc)","Required fields: name, version, package manager","Observations n√™n c√≥: Purpose, Key APIs used, Alternatives, Security notes","Example: Dependency: tokio 1.35 - async runtime","Relations: used_by Module, replaces Dependency"]}
{"name":"Feature: Get Related Tool","entityType":"Feature","observations":["M√¥ t·∫£: Tool m·ªõi l·∫•y c√°c entities c√≥ relation v·ªõi entity cho tr∆∞·ªõc","Status: Proposed","Priority: High","Input: entity_name, relation_type (optional), direction (in/out/both)","Output: List of related entities v·ªõi relation info","Use case: T√¨m t·∫•t c·∫£ files trong module, t√¨m dependencies c·ªßa function","Status: Completed","Implemented: 2026-01-11","File: memory.rs - GetRelatedTool struct","Structs added: RelatedEntity, RelatedEntities"]}
{"name":"Feature: Traverse Tool","entityType":"Feature","observations":["M√¥ t·∫£: Tool m·ªõi cho multi-hop graph traversal","Status: Proposed","Priority: Medium","Input: start_node, path_pattern (e.g., 'depends_on->uses->*')","Output: All nodes matching the path pattern","Use case: T√¨m transitive dependencies, impact analysis","Status: Completed","Implemented: 2026-01-11","File: memory.rs - TraverseTool struct","Structs added: PathStep, TraversalPath, TraversalResult"]}
{"name":"Feature: Summarize Tool","entityType":"Feature","observations":["M√¥ t·∫£: Tool m·ªõi t√≥m t·∫Øt subset c·ªßa graph","Status: Proposed","Priority: Low","Input: entity_names ho·∫∑c filter criteria","Output: Condensed summary c·ªßa selected entities","Use case: Quick overview c·ªßa module, project status","Status: Completed","Implemented: 2026-01-11","File: memory.rs - SummarizeTool struct","Structs added: Summary, EntityBrief","Formats: brief, detailed, stats"]}
{"name":"Feature: Timestamp Tracking","entityType":"Feature","observations":["Option D Hybrid implementation - stores Unix timestamp in seconds","created_at and updated_at fields on Entity","created_at field on Relation","Backward compatible with skip_serializing_if = is_zero","All 4 unit tests passing","Release build successful"],"createdAt":1768061136,"updatedAt":1768061141}
{"name":"Bug: Update Paradox","entityType":"Bug","observations":["JSONL l∆∞u static snapshot, kh√¥ng ph·∫£i event sourcing","Khi update: ho·∫∑c c√≥ 2 d√≤ng m√¢u thu·∫´n, ho·∫∑c m·∫•t immutable history","Priority: Medium","Solution: Th√™m Temporal Edges v·ªõi valid_from/valid_to","FIXED: Added validFrom/validTo fields to Relation struct","FIXED: New tool get_relations_at_time - query relations valid at specific timestamp","FIXED: New tool get_relation_history - view all relations including expired ones","Total tools now: 16 (9 memory + 3 query + 2 temporal + 1 time + 1 summarize)","Status: Resolved"],"createdAt":1768062649,"updatedAt":1768063434}
{"name":"Bug: Context Window Killer","entityType":"Bug","observations":["read_graph dump to√†n b·ªô graph","V·ªõi 10000 nodes s·∫Ω tr√†n context window c·ªßa LLM","Priority: High","Solution: Implement Graph RAG, ch·ªâ l·∫•y relevant nodes + 1-hop neighbors","FIXED: Added limit/offset to read_graph for pagination","FIXED: Added limit/includeRelations to search_nodes","AI agents can now control context size when querying large graphs","Status: Resolved"],"createdAt":1768062649,"updatedAt":1768063183}
{"name":"Bug: Semantic Blindness","entityType":"Bug","observations":["search_nodes ch·ªâ d√πng text matching ƒë∆°n thu·∫ßn","Search 'Coder' kh√¥ng t√¨m ƒë∆∞·ª£c 'Software Engineer'","Priority: High","Solution: T√≠ch h·ª£p Vector Search v·ªõi embeddings","FIXED: Implemented synonym dictionary with 15+ groups","Covers: developer roles, bug/issue, feature/task, status, priority, project mgmt, docs, testing, architecture","Search 'coder' now matches 'programmer', 'developer', 'engineer', 'dev'","Zero dependencies - pure Rust, no AI models needed","Status: Resolved"],"createdAt":1768062649,"updatedAt":1768063937}
{"name":"Refactoring: Memory Graph Modularization","entityType":"Decision","observations":["Quy·∫øt ƒë·ªãnh t√°i c·∫•u tr√∫c memory.rs (2505 d√≤ng) th√†nh multi-file architecture","M·ª•c ti√™u: D·ªÖ maintain, test, v√† m·ªü r·ªông t√≠nh nƒÉng m·ªõi","Gi·ªØ nguy√™n hi·ªáu su·∫•t v·ªõi zero-cost abstractions","5 Phases: Types ‚Üí Protocol ‚Üí KnowledgeBase ‚Üí Tools ‚Üí Cleanup","‚úÖ Refactoring ho√†n th√†nh th√†nh c√¥ng - 2026-01-11","T·ª´ 1 file memory.rs (2505 d√≤ng) ‚Üí 35+ files trong src/","All 16 tests passed (7 unit + 8 integration + 1 doc)","Build release th√†nh c√¥ng v·ªõi LTO optimization","C·∫•u tr√∫c m·ªõi: types/, protocol/, knowledge_base/, tools/, search/, validation/, utils/, server/"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768095691,"updatedAt":1768096450}
{"name":"Module: src/types","entityType":"Module","observations":["Ch·ª©a t·∫•t c·∫£ data models: Entity, Relation, KnowledgeGraph","Files: mod.rs, entity.rs, relation.rs, graph.rs, observation.rs, traversal.rs, summary.rs"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768095691,"updatedAt":1768095691}
{"name":"Module: src/protocol","entityType":"Module","observations":["Ch·ª©a JSON-RPC v√† MCP protocol types","Files: mod.rs, jsonrpc.rs, mcp.rs","Includes Tool trait definition"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768095691,"updatedAt":1768095691}
{"name":"Module: src/knowledge_base","entityType":"Module","observations":["Core engine v·ªõi thread-safe operations","Files: mod.rs, crud.rs, query.rs, traversal.rs, temporal.rs, summarize.rs","üîÑ RwLock Migration - 2026-01-11","Chuy·ªÉn t·ª´ std::sync::Mutex sang std::sync::RwLock","L√Ω do: H·ªá th·ªëng read-heavy (60% read vs 40% write)","Thay ƒë·ªïi mod.rs: Mutex<KnowledgeGraph> ‚Üí RwLock<KnowledgeGraph>","Thay ƒë·ªïi mod.rs: .lock() ‚Üí .read() cho load_graph()","Thay ƒë·ªïi crud.rs: 6x .lock() ‚Üí .write() cho CRUD operations","Performance benefit: Cho ph√©p multiple concurrent readers","Test result: 16/16 tests passed including concurrent access tests","Documentation: docs/Proposed-RwLock.md"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768095691,"updatedAt":1768098901}
{"name":"Module: src/tools","entityType":"Module","observations":["15 MCP tools organized by category","Submodules: memory/ (9 tools), query/ (3 tools), temporal/ (3 tools)"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768095691,"updatedAt":1768095691}
{"name":"Decision: Mutex to RwLock Migration","entityType":"Decision","observations":["Date: 2026-01-11","Status: Completed","Risk Level: LOW","Affected files: src/knowledge_base/mod.rs, src/knowledge_base/crud.rs","Rationale: System is read-heavy (search, traverse, get_related = 60% of operations)","Before: Mutex blocks all threads even for read-only operations","After: RwLock allows multiple concurrent readers, only write blocks","Pattern: Write lock held during entire CRUD + persist_to_file()","Validation: All 16 tests passed including test_concurrent_access and test_concurrent_read_write","Rollback: Simple - change RwLock back to Mutex if issues arise"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768098901,"updatedAt":1768098901}
{"name":"Research: Graph Reasoning Capability Analysis","entityType":"Research","observations":["Date: 2026-01-11","Topic: Ranh gi·ªõi gi·ªØa 'l∆∞u tr·ªØ tri th·ª©c' v√† 'tr√≠ tu·ªá'","Conclusion: Graph ƒë√£ c√≥ n·ªÅn t·∫£ng suy lu·∫≠n, ch∆∞a c√≥ inference engine","Key insight: ƒê√¢y kh√¥ng ph·∫£i memory cho AI, ƒë√¢y l√† h·∫°t nh√¢n c·ªßa tr√≠ tu·ªá c√≥ th·ªÉ ki·ªÉm ch·ª©ng"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Feature: Rule-based Inference Engine","entityType":"Feature","observations":["M√¥ t·∫£: Layer 1 - Logic programming tr√™n graph","Status: Proposed","Priority: High","Cost: Low (kh√¥ng c·∫ßn ML)","Example rule: IF A depends_on B AND B depends_on C THEN A transitively_depends_on C","Example rule: IF Risk threatens Milestone AND Milestone includes Feature THEN Risk threatens Feature","Implementation: rules/*.rs - match tr√™n graph snapshot, sinh derived relations (inferred=true)","Capability: Suy lu·∫≠n ch·ªß ƒë·ªông, kh√¥ng ch·ªâ tr·∫£ l·ªùi c√¢u h·ªèi ƒë∆∞·ª£c h·ªèi"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Feature: Typed Relations with Semantics","entityType":"Feature","observations":["M√¥ t·∫£: Layer 2 - Chu·∫©n h√≥a relationType th√†nh enum + metadata","Status: Proposed","Priority: Medium","Schema: RelationType { transitive: bool, strength: f32, category: Category }","Capability: Reasoning c√≥ tr·ªçng s·ªë, conflict resolution, ranking k·∫øt lu·∫≠n","Enables: Graph 'hi·ªÉu' √Ω nghƒ©a quan h·ªá, kh√¥ng ch·ªâ string matching"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Feature: Hybrid Neuro-Symbolic Reasoning","entityType":"Feature","observations":["M√¥ t·∫£: Layer 4 - K·∫øt h·ª£p symbolic (rules) + GNN (probabilistic)","Status: Future Vision","Priority: Low (5-20 nƒÉm)","Pipeline: Graph snapshot ‚Üí Symbolic inference ‚Üí GNN scoring ‚Üí Confidence-weighted conclusions","Capability: Suy lu·∫≠n v∆∞·ª£t d·ªØ li·ªáu g·ªëc m√† kh√¥ng hallucinate"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Feature: Self-Extending Knowledge Graph","entityType":"Feature","observations":["M√¥ t·∫£: Graph t·ª± ƒë·ªÅ xu·∫•t relations m·ªõi, rules m·ªõi","Status: Future Vision","Risk: High-risk, high-reward","Human role: Approve/Reject proposals","Capability: Tr√≠ tu·ªá tƒÉng theo th·ªùi gian, kh√¥ng c·∫ßn retrain"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Feature: Temporal Counterfactual Reasoning","entityType":"Feature","observations":["M√¥ t·∫£: Tr·∫£ l·ªùi c√¢u h·ªèi 'what-if' theo th·ªùi gian","Status: Future Vision","Example: 'N·∫øu Decision X kh√¥ng ƒë∆∞·ª£c ƒë∆∞a ra, Milestone Y c√≥ tr·ªÖ kh√¥ng?'","Requirements: Temporal graph, alternative timelines, simulation tr√™n graph"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Insight: Graph as Prefrontal Cortex for AI","entityType":"Insight","observations":["Concept: LLM = tr·ª±c gi√°c, Graph = tr√≠ nh·ªõ + logic + ki·ªÉm ch·ª©ng","Agent capability: L·∫≠p lu·∫≠n, ph·∫£n bi·ªán, t·ª± ki·ªÉm tra","Vision: AI Agent kh√¥ng ch·ªâ tr·∫£ l·ªùi m√† suy lu·∫≠n c√≥ cƒÉn c·ª©","Differentiator: V∆∞·ª£t xa RAG truy·ªÅn th·ªëng"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768108015,"updatedAt":1768108015}
{"name":"Feature: Inference Engine v1.2.0","entityType":"Feature","observations":["Implemented TransitiveDependencyRule with BFS traversal","Uses VecDeque for shortest-path-first (Occam's Razor)","Cycle detection via HashSet prevents infinite loops","Configurable max depth (1-5, default 3)","Confidence decay per relation type (0.95-0.60)","16th MCP tool: infer","31 tests passing (22 unit + 8 integration + 1 doc)","Runtime only - inferred relations NOT persisted (Option A design)"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768112140,"updatedAt":1768112140}
{"name":"Bug: Git Stash Data Loss","entityType":"Bug","observations":["Ng√†y ph√°t hi·ªán: 2026-01-11","Context: ƒêang stash code inference engine (16 tools, 14 file changes)","Root cause: git stash push -m ch·ªâ stash tracked files, untracked files b·ªã b·ªè qua","L·ªói ti·∫øp theo: git stash drop x√≥a stash c≈© TR∆Ø·ªöC KHI t·∫°o stash m·ªõi v·ªõi -u flag","H·∫≠u qu·∫£: M·∫•t 8 file modified (CHANGELOG.md, Cargo.toml, lib.rs, mod.rs files)","Tri·ªáu ch·ª©ng: Sau khi ho√†n t·∫•t quy tr√¨nh c√≤n 15 tools thay v√¨ 16 tools"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768113844,"updatedAt":1768113844}
{"name":"Lesson: Git Stash Best Practices","entityType":"Convention","observations":["LU√îN d√πng git stash push -u ƒë·ªÉ bao g·ªìm untracked files","KH√îNG BAO GI·ªú d√πng git stash drop tr∆∞·ªõc khi verify stash m·ªõi ƒë√£ capture ƒë·∫ßy ƒë·ªß","N·∫øu c·∫ßn thay ƒë·ªïi stash: d√πng git stash pop ‚Üí s·ª≠a ‚Üí git stash push l·∫°i","Recovery: git fsck --lost-found t√¨m dangling commits t·ª´ dropped stash","Recovery: git stash apply <commit-hash> ƒë·ªÉ kh√¥i ph·ª•c stash ƒë√£ drop","Dangling commits t·ªìn t·∫°i ~2 tu·∫ßn tr∆∞·ªõc khi b·ªã git gc x√≥a"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768113844,"updatedAt":1768113844}
{"name":"Proposed: Team Collaboration Architecture","entityType":"Proposal","observations":["Status: Proposed (2026-01-11), Priority: Future Enhancement, Complexity: High","M·ª•c ti√™u: Chuy·ªÉn Memory Graph t·ª´ 'C√¥ng c·ª• c√° nh√¢n' sang 'H·ªá ƒëi·ªÅu h√†nh Team' - PM, BA, Dev, Tester c√πng l√†m vi·ªác tr√™n 1 Knowledge Graph","Ki·∫øn tr√∫c ƒë·ªÅ xu·∫•t: Memory Hub v·ªõi Hybrid Protocol Strategy","Protocol 1 - MCP SSE (P0): Cho AI Agents (Cursor, Claude) k·∫øt n·ªëi qua HTTP thay v√¨ stdio","Protocol 2 - GraphQL (P1): Cho PM/BA/Frontend Dashboard v·ªõi query linh ho·∫°t","Protocol 3 - REST API (P2): Cho CI/CD, Scripts, 3rd party integrations","Tech Stack: Axum (web framework), async-graphql (GraphQL), tokio (async runtime)","Phase 1 (1-2 weeks): MCP SSE Transport + API Key Auth + Single Instance","Phase 2 (2-3 weeks): GraphQL API + Event Sourcing + SQLite Storage","Phase 3 (2 weeks): Authentication (API Key + RBAC) + Database Migration (PostgreSQL)","Risks: Race Conditions (mitigate: RwLock ‚Üí DB locking), Context Overflow (mitigate: Pagination + Vector search), Data Conflicts (mitigate: Event Sourcing + CRDT)","Open Questions: Conflict Resolution Strategy? Offline Support? Authorization Granularity? Deployment Model?","Roadmap: Month 1-2 (MVP 5 devs) ‚Üí Month 3-4 (Team 10-20) ‚Üí Month 5+ (Enterprise ready)","Document: docs/Proposed-Team-Collaboration.md"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768118779,"updatedAt":1768118779}
{"name":"Module: ui","entityType":"Module","observations":["Path: ui/","Purpose: Web-based visualization v√† Inference Lab cho Memory Graph","Tech Stack: Vanilla JS + Sigma.js (graph viz) + Graphology (graph data structure)","No build step - pure HTML/CSS/JS, works with Live Server","Features: Graph visualization, Node detail panel, Inference testing, CRUD entities/relations","Created: 2026-01-11","[Sigma.js Demo Reference] Source: https://github.com/jacomyal/sigma.js/tree/main/packages/demo","[Pattern: Search & Focus] SearchField.tsx: D√πng sigma.getNodeDisplayData(nodeId) ƒë·ªÉ l·∫•y display coordinates, sau ƒë√≥ camera.animate({ ...nodeDisplayData, ratio: 0.05 }, { duration: 600 }). L∆∞u √Ω: ratio 0.05 r·∫•t nh·ªè nh∆∞ng h·ªç d√πng v·ªõi spread operator l·∫•y x, y t·ª´ displayData.","[Pattern: Highlight Neighborhood] GraphSettingsController.tsx: D√πng nodeReducer v√† edgeReducer ƒë·ªÉ fade nodes/edges kh√¥ng li√™n quan. NODE_FADE_COLOR = '#bbb', EDGE_FADE_COLOR = '#eee'. Nodes kh√¥ng connected s·∫Ω c√≥ color fade, label = '', highlighted = false.","[Pattern: Debounce Hover] useDebounce(hoveredNode, 40) ƒë·ªÉ tr√°nh render qu√° nhi·ªÅu khi di chu·ªôt nhanh.","[Pattern: Custom Hover Renderer] canvas-utils.ts: drawHover() v·∫Ω n·ªÅn tr·∫Øng (#fff) v·ªõi shadow, sau ƒë√≥ v·∫Ω text m√†u ƒëen (#000). D√πng drawRoundRect ƒë·ªÉ v·∫Ω background bo g√≥c.","[Pattern: Custom Label Renderer] canvas-utils.ts: drawLabel() v·∫Ω background semi-transparent (#ffffffcc) r·ªìi v·∫Ω text ƒëen (#000) - ƒë·∫£m b·∫£o ƒë·ªçc ƒë∆∞·ª£c tr√™n m·ªçi n·ªÅn.","[Pattern: Filtering] GraphDataController.tsx: Set graph.setNodeAttribute(node, 'hidden', true/false) ƒë·ªÉ hide/show nodes. Hidden nodes kh√¥ng hi·ªÉn th·ªã v√† b·ªã exclude kh·ªèi search.","[Pattern: setSetting vs attributes] D√πng sigma.setSetting('nodeReducer', fn) ƒë·ªÉ modify display data on-the-fly, kh√¥ng modify actual graph data. Return null ƒë·ªÉ reset reducer.","[Bug Fix Applied] focusOnNode(): Thay ratio: 0.3 b·∫±ng Math.min(currentRatio, 1.5) ƒë·ªÉ tr√°nh zoom qu√° s√¢u g√¢y m√†n h√¨nh ƒëen.","[UI Design Lesson] Layout 3-column: Left sidebar (filters/controls) + Center (graph) + Right sidebar (details). Inspired by Sigma.js official demo.","[UI Design Lesson] Collapsible sidebars c·∫ßn width t·ªëi thi·ªÉu (50px) ƒë·ªÉ hi·ªán toggle button, kh√¥ng d√πng width: 0.","[UI Design Lesson] Toggle button n√™n n·∫±m B√äN TRONG sidebar (left: 6px) thay v√¨ ngo√†i (left: -14px) ƒë·ªÉ kh√¥ng b·ªã c·∫Øt khi collapsed.","[UI Design Lesson] Search autocomplete: D√πng custom dropdown v·ªõi highlight text match thay v√¨ native <datalist>. H·ªó tr·ª£ keyboard navigation (‚Üë‚Üì + Enter + Escape).","[UI Design Lesson] Filter pattern: Checkbox cho t·ª´ng type, d√πng graph.setNodeAttribute(node, 'hidden', true/false) ƒë·ªÉ ·∫©n/hi·ªán realtime.","[UI Design Lesson] Custom label/hover renderer: N·ªÅn t·ªëi (#0f172a) + text s√°ng (#e5e7eb) cho dark theme. Sigma.js d√πng defaultDrawNodeLabel v√† defaultDrawNodeHover.","[UI Design Lesson] Edge arrows: defaultEdgeType: 'arrow', edgeArrowPosition: 'target', edgeArrowSize: 4 (nh·ªè, subtle).","[UI Design Lesson] focusOnNode(): D√πng renderer.getNodeDisplayData(nodeId) thay v√¨ graph.getNodeAttributes() ƒë·ªÉ l·∫•y screen coordinates. Tr√°nh ratio qu√° nh·ªè (0.3) g√¢y m√†n h√¨nh ƒëen.","[UI Design Lesson] Highlight pattern: D√πng nodeReducer v√† edgeReducer ƒë·ªÉ fade nodes/edges kh√¥ng li√™n quan. Reset b·∫±ng setSetting('nodeReducer', null).","[UI Design Lesson] CSS Variables: T·∫≠p trung colors, spacing, transitions v√†o :root ƒë·ªÉ d·ªÖ maintain v√† consistent."],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768128254}
{"name":"File: ui/index.html","entityType":"File","observations":["Main HTML entry point","Contains: Sidebar v·ªõi 3 tabs (Inference, Entities, Relations)","Contains: Graph container v·ªõi Sigma.js renderer","Contains: Modals cho Add/Edit Entity v√† Add Relation","Contains: Node Detail Panel (persistent on click)","External deps: Sigma.js 2.4.0, Graphology 0.25.4 (CDN)","~280 lines"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768123521}
{"name":"File: ui/css/styles.css","entityType":"File","observations":["All CSS styles for the UI","Dark theme v·ªõi color palette t·ª´ Tailwind (slate, blue, green)","Components: Sidebar, Tabs, Panels (collapsible), Stats, Legend, Forms, Buttons, Modals","Node Detail Panel styles v·ªõi connection items","Responsive scrolling cho tab content v√† inference results","~900 lines"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768123521}
{"name":"File: ui/js/app.js","entityType":"File","observations":["Main application logic","Functions: init(), rebuildGraph(), setupGraphEvents(), updateStats(), buildLegend()","Node interaction: showNodeDetail(), closeNodeDetail(), focusOnNode(), highlightConnections()","CRUD handlers: showAddEntityModal(), editEntity(), saveEntity(), deleteEntity()","Relation handlers: showAddRelationModal(), saveRelation(), deleteRelation()","Event listeners: tabs, panels collapse, toolbar buttons, inference controls","~760 lines","Bug: focusOnNode() - Camera animate nh∆∞ng graph kh√¥ng hi·ªÉn th·ªã (m√†n h√¨nh ƒëen), ph·∫£i nh·∫•n Reset m·ªõi th·∫•y. Nguy√™n nh√¢n: ratio: 0.3 qu√° nh·ªè khi·∫øn zoom qu√° s√¢u v√†o node.","[Reference] Sigma.js demo pattern cho search: getNodeDisplayData() tr·∫£ v·ªÅ screen coordinates, d√πng l√†m target cho camera.animate()","[Reference] Sigma.js official demo d√πng ratio: 0.05 v·ªõi displayData spread, kh√°c v·ªõi graph attributes x/y"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768125887}
{"name":"File: ui/js/graph.js","entityType":"File","observations":["Graph visualization module","Exports: GraphModule object","Functions: colorByType(), buildGraph(), calculateStats()","typeColors: 20+ entity type color mappings","Layout: Radial layout grouped by entity type","~150 lines"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768123521}
{"name":"File: ui/js/inference.js","entityType":"File","observations":["Inference engine for UI (client-side simulation)","Exports: InferenceModule object","Functions: runInference() - BFS traversal v·ªõi confidence decay","Functions: formatPath(), getConfidenceColor(), deriveInferredType()","relationConfidence: confidence values per relation type (0.60-0.95)","Special rules: transitively_depends_on, contributes_to, indirectly_threatens","~180 lines"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768123521}
{"name":"File: ui/js/editor.js","entityType":"File","observations":["DataEditor class for CRUD operations","Methods: loadFromURL(), addEntity(), updateEntity(), deleteEntity()","Methods: addRelation(), deleteRelation(), addObservation(), removeObservation()","Export: exportToJSONL(), downloadJSONL()","Query: searchEntities(), getRelationsForEntity(), getEntityTypes(), getRelationTypes()","Utility: showToast() for notifications","~200 lines"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768123521}
{"name":"File: ui/favicon.svg","entityType":"File","observations":["Custom SVG favicon","Design: Brain outline v·ªõi gradient (purple ‚Üí blue ‚Üí cyan)","Contains: 5 graph nodes v·ªõi connections b√™n trong","Symbolizes: Knowledge graph inside a brain (AI memory)"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768123521,"updatedAt":1768123521}
{"name":"Feature: Event Sourcing Architecture","entityType":"Feature","observations":["M√¥ t·∫£: Ki·∫øn tr√∫c Event Sourcing cho Memory Graph - append-only event log + snapshots","Status: COMPLETED (2026-01-11)","Priority: High","Document: docs/Proposed-Event-Sourcing.md","Env Variable: MEMORY_EVENT_SOURCING=true ƒë·ªÉ enable","=== PHASE 0: Preparation ===","T·∫°o data/ directory structure: data/events.jsonl, data/snapshots/, data/archive/","Backup memory.jsonl th√†nh memory.jsonl.backup","=== PHASE 1: Event Types (6 tests) ===","File: src/types/event.rs - EventType enum v·ªõi 6 variants: EntityCreated, EntityDeleted, RelationCreated, RelationDeleted, ObservationAdded, ObservationDeleted","Event struct v·ªõi id, event_type, timestamp, payload","Serde serialization support","=== PHASE 2: Event Store Core (8 tests) ===","File: src/event_store/mod.rs - EventStore struct v·ªõi append(), replay(), get_events_since()","File: src/event_store/config.rs - EventStoreConfig v·ªõi paths, snapshot_threshold, archive_old_events","File locking v·ªõi fs2 crate ƒë·ªÉ prevent concurrent writes","=== PHASE 3: Snapshots (11 tests) ===","File: src/event_store/snapshot.rs - SnapshotManager v·ªõi create_snapshot(), load_latest_snapshot()","Snapshot format: snapshot_{timestamp}_{event_id}.json","Auto-snapshot khi events v∆∞·ª£t threshold (default 100)","=== PHASE 4: Integration ===","Modified src/knowledge_base/crud.rs - t·∫•t c·∫£ CRUD operations emit events","create_entities(), delete_entities(), create_relations(), delete_relations(), add_observations(), delete_observations()","maybe_create_snapshot() check sau m·ªói operation","=== PHASE 5: Graceful Shutdown ===","Integrated ctrlc handler trong main.rs","T·∫°o final snapshot tr∆∞·ªõc khi shutdown","=== PHASE 6: Migration (4 tests) ===","File: src/event_store/migration.rs - migrate_from_legacy()","ƒê·ªçc memory.jsonl, convert th√†nh events, write v√†o events.jsonl","Rename memory.jsonl th√†nh memory.jsonl.migrated","=== PHASE 7: E2E Testing (7 tests) ===","test_full_event_sourcing_lifecycle","test_recovery_from_events_only","test_recovery_from_snapshot_plus_events","test_multiple_snapshots","test_event_ordering","test_concurrent_operations","test_legacy_migration_e2e","=== PHASE 8: Enhancements (6 tests) ===","File: src/event_store/rotation.rs - LogRotation cho archive management","Functions: rotate_after_snapshot(), list_archives(), cleanup_old_archives()","Archive path: data/archive/events_{start}_to_{end}.jsonl","File: src/event_store/stats.rs - EventStoreStats, StatsCollector, ReplayBenchmark","Metrics: active_event_count, archived_event_count, events_by_type HashMap, events_per_second","Auto-rotation: Khi config.archive_old_events=true, t·ª± ƒë·ªông archive sau snapshot","=== TOTAL ===","73 tests passing (57 unit + 7 E2E + 8 integration)","Release build successful","New files: 7 (event.rs, mod.rs, config.rs, snapshot.rs, migration.rs, rotation.rs, stats.rs)","Modified files: lib.rs, main.rs, knowledge_base/mod.rs, knowledge_base/crud.rs","UI Update (2026-01-11): Th√™m stats panel cho Event Sourcing metrics","Stats panel hi·ªÉn th·ªã: Total events, Last snapshot, Event rate, File sizes","Files updated: ui/index.html, ui/js/app.js, ui/css/styles.css","API endpoint: get_stats tool ƒë√£ c√≥ s·∫µn trong event_store/stats.rs"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768139202,"updatedAt":1768139741}
{"name":"Module: src/event_store","entityType":"Module","observations":["Path: src/event_store/","Purpose: Event Sourcing implementation cho Memory Graph","Files: mod.rs, config.rs, snapshot.rs, migration.rs, rotation.rs, stats.rs","Exports: EventStore, EventStoreConfig, SnapshotManager, LogRotation, ArchiveInfo, EventStoreStats, StatsCollector, ReplayBenchmark","Tests: 42 unit tests (events 6 + store 8 + snapshot 11 + migration 4 + rotation 3 + stats 3 + misc 7)","Created: 2026-01-11"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768139202,"updatedAt":1768139202}
{"name":"Proposed: WebSocket Real-time UI","entityType":"Proposal","observations":["Status: Proposed (2026-01-11)","Priority: P1 - After Inference Engine","Complexity: Medium","Estimated Effort: ~8 hours","File: docs/proposal/Proposed-WebSocket-UI.md","M·ª•c ti√™u: UI t·ª± ƒë·ªông c·∫≠p nh·∫≠t khi c√≥ thay ƒë·ªïi entities/relations t·ª´ b·∫•t k·ª≥ client n√†o","Approach: WebSocket + Tokio Broadcast Channel (ti√™u chu·∫©n v√†ng Rust Async)","Architecture: stdio(MCP) + REST(CRUD) + WS(/ws) ‚Üí Event Batcher ‚Üí broadcast::Sender ‚Üí KnowledgeBase","Message Protocol: sequence_id tracking, batch_update support","Reconnection Strategy: 'Snapshot then Subscribe' - full refresh n·∫øu gap > 100 events","Authentication: Query Param Token (?token=xxx) do browser WS kh√¥ng h·ªó tr·ª£ custom headers","Flow Control: Event Batcher debounce 50ms, max 100 events per batch","Dependencies: axum 0.7 (ws), tokio, tokio-tungstenite 0.21, tower-http 0.5","Phase 1: Basic WS endpoint + broadcast (2h)","Phase 2: Integrate with mutation tools (2h)","Phase 3: Event Batcher (1h)","Phase 4: Sequence ID tracking (1h)","Phase 5: UI JavaScript client - MemoryGraphWS class (1.5h)","Phase 6: Reconnection + error handling (0.5h)","Integration: Event Sourcing l√† Source of Truth, WebSocket l√† Live Projection","B3K Review: ƒê·∫°t ƒëi·ªÉm tuy·ªát ƒë·ªëi, kh√¥ng c√≥ l·ªó h·ªïng l·ªõn","[2026-01-11] IMPLEMENTATION COMPLETE - All 8 phases done","Phase 7: CLI --mode flag (stdio|http|both) + --help","Phase 8: 82 tests pass, version bumped to 1.3.0","New files: src/api/ (6 files), ui/js/websocket.js","HTTP server: port 3030, /ws endpoint, /health check","Build verified: cargo build --release success"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768142834,"updatedAt":1768144693}
{"name":"Test SSE Entity","entityType":"Test","observations":["Created via SSE transport"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768313592,"updatedAt":1768313592}
{"name":"Session: 2026-01-14 Copilot Memory Q&A","entityType":"ConversationSummary","observations":["Duration: ~5 minutes","Goal: Hi·ªÉu c∆° ch·∫ø ho·∫°t ƒë·ªông c·ªßa VS Code Copilot Agent v·ªÅ memory/history","Questions asked: 3 c√¢u h·ªèi v·ªÅ chat history, embeddings, v√† long-term memory","Q1: Chat history c√≥ embedding kh√¥ng? ‚Üí Kh√¥ng, l∆∞u d·∫°ng plain text","Q2: History d√†i ·∫£nh h∆∞·ªüng context kh√¥ng? ‚Üí C√≥, s·∫Ω b·ªã summarize khi qu√° d√†i","Q3: L√†m sao l∆∞u l·ªãch s·ª≠ l√¢u d√†i? ‚Üí D√πng Memory Graph MCP Server","Key insight: Memory Graph MCP l√† gi·∫£i ph√°p ƒë·ªÉ AI nh·ªõ l√¢u d√†i, v∆∞·ª£t qua gi·ªõi h·∫°n context window","Workspace: memory-graph project","File ƒëang m·ªü: memory.jsonl","Test: ƒêang test workflow l∆∞u conversation summary v√†o memory-graph","Next: Verify entity ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng trong memory.jsonl"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768349418,"updatedAt":1768349418}
{"name":"Bug: Dual KnowledgeBase Instances","entityType":"Bug","observations":["CRITICAL: main.rs:199-202 t·∫°o 2 KnowledgeBase ƒë·ªôc l·∫≠p","kb_sync = Arc::new(KnowledgeBase::new()) - d√πng cho SSE/MCP tools","kb_async = Arc::new(RwLock::new(KnowledgeBase::new())) - d√πng cho REST/WebSocket","H·∫≠u qu·∫£: Data divergence - 2 graph ho√†n to√†n kh√¥ng sync v·ªõi nhau","H·∫≠u qu·∫£: MCP tools ghi v√†o kb_sync, REST API ƒë·ªçc t·ª´ kb_async -> kh√¥ng th·∫•y data","H·∫≠u qu·∫£: Snapshot ch·ªâ l∆∞u 1 trong 2 graph","Priority: P0 - BLOCKING RELEASE","Discovered by: ChatGPT Code Review","Discovered date: 2026-01-14","Status: Open","=== FIX PLAN ===","Phase 1: Single Source of Truth","- Lo·∫°i b·ªè kb_async, ch·ªâ gi·ªØ kb_sync","- S·ª≠a AppState ƒë·ªÉ nh·∫≠n Arc<KnowledgeBase> thay v√¨ Arc<RwLock<KB>>","- REST/WebSocket endpoints g·ªçi tr·ª±c ti·∫øp v√†o kb_sync","Phase 2: Refactor REST handlers","- Thay state.kb.read().await b·∫±ng state.kb.method() (sync call)","- KnowledgeBase ƒë√£ c√≥ internal RwLock, kh√¥ng c·∫ßn outer lock","Phase 3: WebSocket sync","- Broadcaster v·∫´n ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng","- Khi MCP tool mutate -> emit event -> WebSocket broadcast","Files c·∫ßn s·ª≠a:","- src/main.rs: run_http_server()","- src/api/websocket/state.rs: AppState struct","- src/api/rest/*.rs: T·∫•t c·∫£ handlers","- src/api/http.rs: create_router_with_auth()","Estimated effort: 2-3 hours","Risk: Medium - c·∫ßn test k·ªπ concurrent access","=== FIX COMPLETED: 2026-01-14 ===","Status: RESOLVED","Changes made:","- src/api/websocket/state.rs: AppState.kb changed from Arc<RwLock<KB>> to Arc<KB>","- src/main.rs: Removed kb_async, use single kb instance for both SSE and REST/WS","- src/api/rest/entities.rs: Removed async RwLock access, use sync graph.read()","- src/api/rest/graph.rs: Removed async RwLock access, use sync graph.read()","- src/api/rest/relations.rs: Removed async RwLock access, use sync graph.read()","- src/api/rest/search.rs: Direct sync call to kb.search_nodes()","- src/api/http.rs: Updated tests to use single KB instance","Test result: 95 tests passed, 0 failed","Build: cargo build --release SUCCESS"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768351570,"updatedAt":1768352794}
{"name":"Bug: Nested RwLock Pattern","entityType":"Bug","observations":["AppState.kb s·ª≠ d·ª•ng tokio::RwLock<KnowledgeBase>","KnowledgeBase.graph s·ª≠ d·ª•ng std::sync::RwLock<KnowledgeGraph>","Pattern: state.kb.read().await -> kb.graph.read().unwrap()","Risk: Async task gi·ªØ outer lock qu√° l√¢u c√≥ th·ªÉ g√¢y blocking","Risk: Potential deadlock khi inference/snapshot/event replay","Priority: P1 - Medium","Discovered by: ChatGPT Code Review","Discovered date: 2026-01-14","Status: Open","=== FIX PLAN ===","Option A (Simple - Recommended):","- Sau khi fix Bug: Dual KnowledgeBase, outer lock s·∫Ω b·ªã lo·∫°i b·ªè","- Ch·ªâ c√≤n KnowledgeBase.graph internal RwLock","- Problem t·ª± gi·∫£i quy·∫øt","Option B (Advanced - Future):","- D√πng ArcSwap cho lock-free read","- D√πng im::HashMap cho immutable data structures","- Ch·ªâ c·∫ßn khi scale >100k entities","Recommendation: Fix Bug: Dual KnowledgeBase tr∆∞·ªõc, sau ƒë√≥ re-evaluate","Dependency: Bug: Dual KnowledgeBase ph·∫£i fix tr∆∞·ªõc","=== AUTO-RESOLVED: 2026-01-14 ===","Status: RESOLVED (by fixing Bug: Dual KnowledgeBase Instances)","Outer tokio::RwLock removed from AppState","Now only internal std::sync::RwLock in KnowledgeBase.graph remains","No more nested lock pattern"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768351570,"updatedAt":1768352794}
{"name":"Bug: Inference O(N) Scan","entityType":"Bug","observations":["V·∫•n ƒë·ªÅ: TransitiveDependencyRule scan to√†n b·ªô relations list trong v√≤ng l·∫∑p BFS","Code: graph.relations.iter().filter(|r| r.from == current) - O(N) trong m·ªói iteration","H·∫≠u qu·∫£: O(Nodes √ó Relations) complexity, ch·∫≠m v·ªõi graph l·ªõn (>10k relations)","Priority: P1 - Medium","Solution: Build Adjacency Map (HashMap<String, Vec<&Relation>>) tr∆∞·ªõc khi BFS","Discovered by: B3K Code Review","Discovered date: 2026-01-14","Status: Open","=== FIX COMPLETED: 2026-01-14 ===","Status: RESOLVED","Solution: Th√™m function build_adjacency_map() t·∫°o HashMap<&str, Vec<&Relation>>","Location: src/knowledge_base/inference/rules.rs","Before: O(N) filter trong m·ªói BFS iteration - graph.relations.iter().filter()","After: O(1) lookup via adjacency_map.get(current.as_str())","Complexity change: O(Nodes √ó Relations) ‚Üí O(Nodes + Relations)","Adjacency map ƒë∆∞·ª£c build 1 l·∫ßn tr∆∞·ªõc khi BFS, reuse cho t·∫•t c·∫£ nodes","Test result: 15 inference tests passed","Build: cargo build --release SUCCESS"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768354854,"updatedAt":1768355653}
{"name":"Bug: Relation Key Separator","entityType":"Bug","observations":["V·∫•n ƒë·ªÅ: create_relations check tr√πng b·∫±ng format!(\"{}|{}|{}\", from, to, type)","R·ªßi ro: N·∫øu entity name ch·ª©a k√Ω t·ª± '|', logic check tr√πng s·∫Ω sai","Example: 'A|B' + 'C' + 'type' = 'A|B|C|type' - kh√¥ng ph√¢n bi·ªát ƒë∆∞·ª£c","Priority: P2 - Low","Solution: D√πng Tuple (from, to, type) trong HashSet thay v√¨ String concatenation","Discovered by: B3K Code Review","Discovered date: 2026-01-14","Status: Open","Status: RESOLVED","Fixed: 2026-01-14","Solution: Changed HashSet<String> with format!(\"{}|{}|{}\") to HashSet<(String, String, String)> tuple","Files modified: src/knowledge_base/crud.rs","Benefit: Entity names containing | character no longer cause false duplicate detection"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768354854,"updatedAt":1768357587}
{"name":"Bug: JWT Secret Auto-Generate","entityType":"Bug","observations":["V·∫•n ƒë·ªÅ: JwtAuth::from_env() t·ª± generate random secret n·∫øu kh√¥ng set env var","Code: format!(\"dev-secret-{}\", chrono::Utc::now().timestamp_nanos())","H·∫≠u qu·∫£: Restart server ‚Üí t·∫•t c·∫£ tokens c≈© invalid ‚Üí clients b·ªã logout","Priority: P1 - Medium","Solution: L∆∞u auto-generated secret v√†o file .jwt_secret, ho·∫∑c log warning to","Discovered by: B3K Code Review","Discovered date: 2026-01-14","Status: Open","=== FIX COMPLETED: 2026-01-14 ===","Status: RESOLVED","Solution: Th√™m file-based secret persistence v·ªõi .jwt_secret file","Location: src/api/sse/auth.rs","New functions:","- load_or_create_secret_file(): Load t·ª´ file ho·∫∑c generate m·ªõi v√† save","- generate_secure_secret(): T·∫°o 64-char hex secret (256 bits) t·ª´ multiple entropy sources","Behavior:","1. N·∫øu MEMORY_JWT_SECRET ƒë∆∞·ª£c set ‚Üí d√πng env var (∆∞u ti√™n cao nh·∫•t)","2. N·∫øu .jwt_secret file t·ªìn t·∫°i ‚Üí load t·ª´ file (persist across restarts)","3. N·∫øu kh√¥ng c√≥ ‚Üí generate m·ªõi v√† save v√†o .jwt_secret","Warnings: Log r√µ r√†ng khi d√πng auto-generated secret","Test result: 8 auth tests passed","Build: cargo build --release SUCCESS"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768354854,"updatedAt":1768356742}
{"name":"Bug: SSE Missing Event Replay","entityType":"Bug","observations":["V·∫•n ƒë·ªÅ: Client reconnect sau disconnect kh√¥ng th·ªÉ replay missed events","Hi·ªán t·∫°i: Client reconnect ‚Üí m·∫•t t·∫•t c·∫£ events trong th·ªùi gian disconnect","Priority: P1 - Medium","Solution: Client g·ª≠i last_sequence_id, Server replay t·ª´ event log","C·∫ßn: Index events theo sequence_id, endpoint GET /mcp/events?since=<seq>","Discovered by: ChatGPT Code Review","Discovered date: 2026-01-14","Status: Open","Status: RESOLVED","Fixed: 2026-01-14","Solution: Added event history buffer with circular VecDeque (1000 events) and REST replay endpoint","Files modified: src/api/websocket/broadcaster.rs, src/api/rest/graph.rs, src/api/http.rs","New endpoint: GET /api/events/replay?since=<seq_id>","New methods: get_events_since(), oldest_sequence_id(), history_len()","Tests added: test_event_history_storage, test_get_events_since, test_history_circular_buffer"],"createdBy":"Mai Th√†nh Duy An","updatedBy":"Mai Th√†nh Duy An","createdAt":1768354854,"updatedAt":1768357587}
{"from":"tiach","to":"Memory Graph MCP Server","relationType":"develops"}
{"from":"Memory Graph MCP Server","to":"Feature: Create Entities","relationType":"implements"}
{"from":"Memory Graph MCP Server","to":"Feature: Create Relations","relationType":"implements"}
{"from":"Memory Graph MCP Server","to":"Feature: Search Nodes","relationType":"implements"}
{"from":"Memory Graph MCP Server","to":"Feature: Persistent Storage","relationType":"implements"}
{"from":"tiach","to":"Feature: Create Entities","relationType":"owns"}
{"from":"tiach","to":"Feature: Create Relations","relationType":"owns"}
{"from":"tiach","to":"Feature: Search Nodes","relationType":"owns"}
{"from":"tiach","to":"Feature: Persistent Storage","relationType":"owns"}
{"from":"tiach","to":"Decision: Use JSONL Format","relationType":"made"}
{"from":"tiach","to":"Decision: Use Rust","relationType":"made"}
{"from":"Decision: Use JSONL Format","to":"Feature: Persistent Storage","relationType":"affects"}
{"from":"Decision: Use Rust","to":"Memory Graph MCP Server","relationType":"affects"}
{"from":"Milestone: MVP Release","to":"Feature: Create Entities","relationType":"includes"}
{"from":"Milestone: MVP Release","to":"Feature: Create Relations","relationType":"includes"}
{"from":"Milestone: MVP Release","to":"Feature: Search Nodes","relationType":"includes"}
{"from":"Milestone: MVP Release","to":"Feature: Persistent Storage","relationType":"includes"}
{"from":"Requirement: Unicode Support","to":"Feature: Create Entities","relationType":"satisfied_by"}
{"from":"Requirement: MCP Compliance","to":"Memory Graph MCP Server","relationType":"satisfied_by"}
{"from":"Risk: JSONL Scalability","to":"Milestone: Production Ready","relationType":"threatens"}
{"from":"Risk: Memory Usage","to":"Milestone: Production Ready","relationType":"threatens"}
{"from":"Risk: JSONL Scalability","to":"Decision: Use JSONL Format","relationType":"related_to"}
{"from":"Memory Graph MCP Server","to":"Feature: GNN Integration","relationType":"will_implement"}
{"from":"Memory Graph MCP Server","to":"Feature: Semantic Search","relationType":"will_implement"}
{"from":"Feature: GNN Integration","to":"Feature: Semantic Search","relationType":"depends_on"}
{"from":"Feature: GNN Integration","to":"Milestone: Production Ready","relationType":"planned_for"}
{"from":"Feature: Semantic Search","to":"Milestone: Production Ready","relationType":"planned_for"}
{"from":"tiach","to":"Feature: GNN Integration","relationType":"owns"}
{"from":"tiach","to":"Feature: Semantic Search","relationType":"owns"}
{"from":"Memory Graph MCP Server","to":"EntityType: Module","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"EntityType: File","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"EntityType: Function","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"EntityType: Schema","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"EntityType: BusinessRule","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"EntityType: Convention","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"EntityType: Dependency","relationType":"supports"}
{"from":"Memory Graph MCP Server","to":"Feature: Get Related Tool","relationType":"will_implement"}
{"from":"Memory Graph MCP Server","to":"Feature: Traverse Tool","relationType":"will_implement"}
{"from":"Memory Graph MCP Server","to":"Feature: Summarize Tool","relationType":"will_implement"}
{"from":"Feature: Traverse Tool","to":"Feature: Get Related Tool","relationType":"depends_on"}
{"from":"tiach","to":"Feature: Get Related Tool","relationType":"owns"}
{"from":"tiach","to":"Feature: Traverse Tool","relationType":"owns"}
{"from":"tiach","to":"Feature: Summarize Tool","relationType":"owns"}
{"from":"Bug: Update Paradox","to":"Memory Graph MCP Server","relationType":"affects","createdAt":1768062654}
{"from":"Bug: Context Window Killer","to":"Memory Graph MCP Server","relationType":"affects","createdAt":1768062654}
{"from":"Bug: Semantic Blindness","to":"Memory Graph MCP Server","relationType":"affects","createdAt":1768062654}
{"from":"Decision: Mutex to RwLock Migration","to":"Module: src/knowledge_base","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768098907}
{"from":"Memory Graph MCP Server","to":"Decision: Mutex to RwLock Migration","relationType":"implements","createdBy":"Mai Th√†nh Duy An","createdAt":1768098907}
{"from":"Memory Graph MCP Server","to":"Feature: Rule-based Inference Engine","relationType":"will_implement","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Memory Graph MCP Server","to":"Feature: Typed Relations with Semantics","relationType":"will_implement","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Memory Graph MCP Server","to":"Feature: Hybrid Neuro-Symbolic Reasoning","relationType":"will_implement","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Feature: Typed Relations with Semantics","to":"Feature: Rule-based Inference Engine","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Feature: Hybrid Neuro-Symbolic Reasoning","to":"Feature: GNN Integration","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Feature: Hybrid Neuro-Symbolic Reasoning","to":"Feature: Rule-based Inference Engine","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Feature: Self-Extending Knowledge Graph","to":"Feature: Hybrid Neuro-Symbolic Reasoning","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Feature: Temporal Counterfactual Reasoning","to":"Feature: Typed Relations with Semantics","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Research: Graph Reasoning Capability Analysis","to":"Feature: Rule-based Inference Engine","relationType":"proposes","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Research: Graph Reasoning Capability Analysis","to":"Feature: Typed Relations with Semantics","relationType":"proposes","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"tiach","to":"Feature: Rule-based Inference Engine","relationType":"owns","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"tiach","to":"Feature: Typed Relations with Semantics","relationType":"owns","createdBy":"Mai Th√†nh Duy An","createdAt":1768108033}
{"from":"Feature: Inference Engine v1.2.0","to":"Module: src/knowledge_base","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768112140}
{"from":"Feature: Inference Engine v1.2.0","to":"Decision: Mutex to RwLock Migration","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768112140}
{"from":"Bug: Git Stash Data Loss","to":"Feature: Inference Engine v1.2.0","relationType":"caused_by","createdBy":"Mai Th√†nh Duy An","createdAt":1768113849}
{"from":"Lesson: Git Stash Best Practices","to":"Bug: Git Stash Data Loss","relationType":"fixes","createdBy":"Mai Th√†nh Duy An","createdAt":1768113849}
{"from":"Proposed: Team Collaboration Architecture","to":"Memory Graph MCP Server","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768118783}
{"from":"File: ui/index.html","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/css/styles.css","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/app.js","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/graph.js","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/inference.js","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/editor.js","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/favicon.svg","to":"Module: ui","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/app.js","to":"File: ui/js/graph.js","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/app.js","to":"File: ui/js/inference.js","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/js/app.js","to":"File: ui/js/editor.js","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/index.html","to":"File: ui/css/styles.css","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"File: ui/index.html","to":"File: ui/js/app.js","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768123594}
{"from":"Feature: Event Sourcing Architecture","to":"Memory Graph MCP Server","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768139208}
{"from":"Module: src/event_store","to":"Feature: Event Sourcing Architecture","relationType":"implements","createdBy":"Mai Th√†nh Duy An","createdAt":1768139208}
{"from":"Module: src/event_store","to":"Module: src/knowledge_base","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768139208}
{"from":"Feature: Event Sourcing Architecture","to":"Bug: Update Paradox","relationType":"fixes","createdBy":"Mai Th√†nh Duy An","createdAt":1768139208}
{"from":"Proposed: WebSocket Real-time UI","to":"Memory Graph MCP Server","relationType":"part_of","createdBy":"Mai Th√†nh Duy An","createdAt":1768142841}
{"from":"Proposed: WebSocket Real-time UI","to":"Feature: Event Sourcing Architecture","relationType":"depends_on","createdBy":"Mai Th√†nh Duy An","createdAt":1768142841}
{"from":"Proposed: WebSocket Real-time UI","to":"Proposed: Team Collaboration Architecture","relationType":"relates_to","createdBy":"Mai Th√†nh Duy An","createdAt":1768142841}
{"from":"Bug: Dual KnowledgeBase Instances","to":"Memory Graph MCP Server","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768351587}
{"from":"Bug: Nested RwLock Pattern","to":"Memory Graph MCP Server","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768351587}
{"from":"Bug: Nested RwLock Pattern","to":"Bug: Dual KnowledgeBase Instances","relationType":"related_to","createdBy":"Mai Th√†nh Duy An","createdAt":1768351587}
{"from":"Bug: Inference O(N) Scan","to":"Memory Graph MCP Server","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768354862}
{"from":"Bug: Relation Key Separator","to":"Memory Graph MCP Server","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768354862}
{"from":"Bug: JWT Secret Auto-Generate","to":"Memory Graph MCP Server","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768354862}
{"from":"Bug: SSE Missing Event Replay","to":"Memory Graph MCP Server","relationType":"affects","createdBy":"Mai Th√†nh Duy An","createdAt":1768354862}
